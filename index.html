<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paper Perspective Correction</title>
  
  <meta name="description" content="Free online document perspective correction tool. Fix skewed or distorted document images using 4+ point selection. Checkout the website for more details">
  <meta name="keywords" content="document perspective correction, fix skewed document, image perspective transform, scan correction online, crop document image, rectify scanned documents">
  <meta name="author" content="Advanced Perspective Correction Tool">
  <meta name="robots" content="index, follow">
  
  <link rel="canonical" href="https://ni-kit-mht.github.io/perspective-correction/">
  <link rel="icon" href="/perspective-correction/favicon.ico" type="image/x-icon">
  
  <meta property="og:type" content="website">
  <meta property="og:title" content="Document Perspective Correction Tool – Fix Skewed Scans">
  <meta property="og:description" content="Correct document perspective using 4-point selection. Preserve image quality, crop accurately, revert changes, and download high-quality results.">
  <meta property="og:url" content="https://ni-kit-mht.github.io/perspective-correction/">
  <meta property="og:image" content="https://ni-kit-mht.github.io/perspective-correction/preview.png">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Document Perspective Correction Tool">
  <meta name="twitter:description" content="Fix skewed document images online using precise 4-point perspective correction.">
  <meta name="twitter:image" content="https://ni-kit-mht.github.io/perspective-correction/preview.png">
  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Advanced Perspective Correction Tool",
    "url": "https://ni-kit-mht.github.io/perspective-correction/",
    "description": "Online document perspective correction tool that rectifies skewed or distorted images using 4-point selection while preserving original image quality.",
    "applicationCategory": "PhotoEditingApplication",
    "operatingSystem": "Web",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is document perspective correction?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Document perspective correction fixes skewed or angled images by transforming them into a rectangular, front-facing view."
        }
      },
      {
        "@type": "Question",
        "name": "How does this perspective correction tool work?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "You select at least four points around the document edges and the tool applies a perspective transformation locally in the browser."
        }
      },
      {
        "@type": "Question",
        "name": "Is my image uploaded to a server?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "No. All processing happens locally in your browser and images are never uploaded."
        }
      },
      {
        "@type": "Question",
        "name": "Does this tool reduce image quality?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "No. The original image resolution is preserved during perspective correction."
        }
      }
    ]
  }
  </script>

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="container">
    <header>
      <h1>
        <i class="fas fa-crop-alt"></i>
        Document Perspective Correction Tool
      </h1>
      <p class="subtitle">
        Fix skewed or distorted document images using precise 4-point perspective correction.
        Preserve original resolution, crop unnecessary regions, revert changes, and download
        high-quality corrected results — all directly in your browser.
      </p>
    </header>

    <main class="main-content">
      <!-- LEFT PANEL: Controls -->
      <section class="left-panel">
        <h2 class="panel-title">Controls</h2>

        <div class="control-group">
          <div class="control-label">Upload Image</div>
          <div class="file-upload" id="fileUpload">
            <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
            <p>Click to upload an image or drag and drop</p>
            <p style="font-size: 0.9rem; margin-top: 5px; color: #a5d8ff;">
              Supported formats: JPG, PNG, WebP
            </p>
            <input type="file" id="imageInput" accept="image/*" hidden>
          </div>
        </div>

        <div class="control-group">
          <div class="control-label">Point Selection Mode</div>

          <div class="point-controls">
            <div class="point-btn active" id="addPointsBtn">
              <i class="fas fa-plus-circle"></i> Add Points
            </div>
            <div class="point-btn" id="movePointsBtn">
              <i class="fas fa-arrows-alt"></i> Move Points
            </div>
            <div class="point-btn" id="deletePointsBtn">
              <i class="fas fa-trash-alt"></i> Delete Points
            </div>
          </div>

          <div class="point-counter">
            <span>Points Selected: <strong id="pointCount">0</strong></span>
            <span>Minimum: 4 points required</span>
          </div>
        </div>

        <div class="control-group">
          <button class="btn btn-grid" id="toggleGridBtn" disabled>
            <i class="fas fa-th"></i> Toggle Grid Overlay
          </button>

          <button class="btn" id="transformBtn">
            <i class="fas fa-sync-alt"></i> Apply Perspective Correction
          </button>

          <button class="btn btn-print" id="printBtn" disabled>
            <i class="fas fa-print"></i> Print Corrected Document
          </button>

          <button class="btn btn-download" id="downloadBtn" disabled>
            <i class="fas fa-download"></i> Download Corrected Image
          </button>

          <button class="btn btn-reset" id="resetBtn">
            <i class="fas fa-redo"></i> Reset All Points
          </button>
        </div>

        <div class="status" id="statusMessage">
          Upload an image to begin perspective correction
        </div>
      </section>

      <!-- MIDDLE PANEL: Image Editor -->
      <section class="image-container">
        <h2 class="panel-title">Image Editor</h2>
        <div class="canvas-wrapper">
          <canvas id="sourceCanvas"></canvas>
          <canvas id="pointsCanvas"></canvas>
        </div>
      </section>

      <!-- RIGHT PANEL: Instructions & FAQ -->
      <section class="left-panel">
        <div class="instructions">
          <h2>How to Correct Document Perspective</h2>
          <ul>
            <li>Upload a document or photo taken at an angle</li>
            <li>Select at least 4 points around the document edges</li>
            <li>Adjust points precisely using move mode</li>
            <li>Apply perspective correction to generate a rectangular document</li>
            <li>Download or print the corrected high-resolution image</li>
          </ul>
        </div>

        <section class="faq">
          <div class="instructions">
          <h2>Frequently Asked Questions</h2>
          <details>
            <summary>What is document perspective correction?</summary>
            <p>
              Document perspective correction fixes skewed or angled images by transforming
              them into a rectangular, front-facing view. This is commonly used for scanned
              documents, receipts, whiteboards, and photographed papers.
            </p>
          </details>
        
          <details>
            <summary>How does this perspective correction tool work?</summary>
            <p>
              You select at least four points around the document edges. The tool calculates
              a perspective transformation that rectifies the image while preserving its
              original resolution and image quality.
            </p>
          </details>
        
          <details>
            <summary>Is my image uploaded to a server?</summary>
            <p>
              No. All image processing happens locally in your browser. Your documents are
              never uploaded, stored, or shared.
            </p>
          </details>
        
          <details>
            <summary>Does this tool reduce image quality?</summary>
            <p>
              No. The tool preserves the original image resolution and only removes
              unnecessary areas outside the selected region.
            </p>
          </details>
        
          <details>
            <summary>Can I download or print the corrected document?</summary>
            <p>
              Yes. After perspective correction, you can download a high-quality image
              or print the corrected document directly from the browser.
            </p>
          </details>
          </div>
        </section>
      </section>
    </main>

    <footer>
      <p>
        © 2025 Perspective Correction Tool —
        All image processing happens locally in your browser. No uploads.
      </p>
    </footer>
  </div>

  <script type="module">
    // Global state for grid
    let gridEnabled = false;
    let gridCanvas = null;
    let gridCtx = null;
    let currentImage = null;

    // Clipboard paste functionality
    document.addEventListener('paste', function(e) {
      const items = e.clipboardData?.items;
      if (!items) return;

      for (let i = 0; i < items.length; i++) {
        if (items[i].type.indexOf('image') !== -1) {
          e.preventDefault();
          const blob = items[i].getAsFile();
          const reader = new FileReader();
          reader.onload = function(event) {
            const imageInput = document.getElementById('imageInput');
            // Create a new File object from the blob
            const file = new File([blob], 'pasted-image.png', { type: blob.type });
            // Create a DataTransfer object to simulate file input
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(file);
            imageInput.files = dataTransfer.files;
            // Trigger change event
            const changeEvent = new Event('change', { bubbles: true });
            imageInput.dispatchEvent(changeEvent);
          };
          reader.readAsDataURL(blob);
          break;
        }
      }
    });

    // Initialize grid canvas when image is loaded
    function initGridCanvas() {
      const canvasWrapper = document.querySelector('.canvas-wrapper');
      const sourceCanvas = document.getElementById('sourceCanvas');
      
      if (!gridCanvas) {
        gridCanvas = document.createElement('canvas');
        gridCanvas.id = 'gridCanvas';
        gridCanvas.style.position = 'absolute';
        gridCanvas.style.top = '0';
        gridCanvas.style.left = '0';
        gridCanvas.style.pointerEvents = 'none';
        canvasWrapper.appendChild(gridCanvas);
        gridCtx = gridCanvas.getContext('2d');
      }
      
      gridCanvas.width = sourceCanvas.width;
      gridCanvas.height = sourceCanvas.height;
      
      // Enable grid button
      document.getElementById('toggleGridBtn').disabled = false;
    }

    // Calculate average brightness of the image
    function getAverageBrightness(canvas) {
      const ctx = canvas.getContext('2d');
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = imageData.data;
      let totalBrightness = 0;
      
      // Sample every 10th pixel for performance
      for (let i = 0; i < data.length; i += 40) {
        const r = data[i];
        const g = data[i + 1];
        const b = data[i + 2];
        // Calculate perceived brightness
        const brightness = (0.299 * r + 0.587 * g + 0.114 * b);
        totalBrightness += brightness;
      }
      
      return totalBrightness / (data.length / 40);
    }

    // Draw grid overlay
    function drawGrid() {
      if (!gridCanvas || !gridCtx) return;
      
      gridCtx.clearRect(0, 0, gridCanvas.width, gridCanvas.height);
      
      if (!gridEnabled) return;
      
      const sourceCanvas = document.getElementById('sourceCanvas');
      const brightness = getAverageBrightness(sourceCanvas);
      
      // Use white grid for dark images, black grid for light images
      const gridColor = brightness < 128 ? 'rgba(255, 255, 255, 0.5)' : 'rgba(0, 0, 0, 0.5)';
      
      const gridSize = 30; // Grid cell size in pixels
      
      gridCtx.strokeStyle = gridColor;
      gridCtx.lineWidth = 1;
      gridCtx.setLineDash([5, 5]);
      
      // Draw vertical lines
      for (let x = 0; x < gridCanvas.width; x += gridSize) {
        gridCtx.beginPath();
        gridCtx.moveTo(x, 0);
        gridCtx.lineTo(x, gridCanvas.height);
        gridCtx.stroke();
      }
      
      // Draw horizontal lines
      for (let y = 0; y < gridCanvas.height; y += gridSize) {
        gridCtx.beginPath();
        gridCtx.moveTo(0, y);
        gridCtx.lineTo(gridCanvas.width, y);
        gridCtx.stroke();
      }
      
      gridCtx.setLineDash([]);
    }

    // Toggle grid button handler
    document.getElementById('toggleGridBtn').addEventListener('click', function() {
      gridEnabled = !gridEnabled;
      drawGrid();
      
      // Update button state
      if (gridEnabled) {
        this.style.background = '#28a745';
        this.innerHTML = '<i class="fas fa-th"></i> Hide Grid Overlay';
      } else {
        this.style.background = '#667eea';
        this.innerHTML = '<i class="fas fa-th"></i> Toggle Grid Overlay';
      }
    });

    // Listen for image load events from the main script
    // We'll use a MutationObserver to detect when the canvas changes
    const sourceCanvas = document.getElementById('sourceCanvas');
    const observer = new MutationObserver(function() {
      const ctx = sourceCanvas.getContext('2d');
      // Check if canvas has content
      const imageData = ctx.getImageData(0, 0, sourceCanvas.width, sourceCanvas.height);
      const hasContent = imageData.data.some(channel => channel !== 0);
      
      if (hasContent && sourceCanvas.width > 0 && sourceCanvas.height > 0) {
        initGridCanvas();
        if (gridEnabled) {
          drawGrid();
        }
      }
    });

    // Observe canvas size changes
    const resizeObserver = new ResizeObserver(function() {
      if (sourceCanvas.width > 0 && sourceCanvas.height > 0) {
        initGridCanvas();
        if (gridEnabled) {
          drawGrid();
        }
      }
    });

    resizeObserver.observe(sourceCanvas);
  </script>
  <script type="module" src="script.js"></script>
</body>
</html>
